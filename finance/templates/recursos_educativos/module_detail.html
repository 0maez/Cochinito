{% extends "finance/base.html" %}
{% load static custom_filters %}

{% block title %}Detalle del Módulo - Recursos Educativos{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
  <!-- Título y Descripción del Módulo -->
  <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
    <h1 class="text-4xl font-bold text-gray-800 mb-4">{{ modulo.titulo }}</h1>
    <p class="text-lg text-gray-600 mb-6">{{ modulo.descripcion }}</p>

    <!-- Sección de Video -->
    <div class="mb-8">
      <h3 class="text-2xl font-semibold text-gray-800 mb-4">Video</h3>
      <div class="overflow-hidden rounded-xl shadow-lg">
        <iframe 
            width="560" 
            height="315" 
            class="w-full"
            src="https://www.youtube.com/embed/{{ modulo.video_url|cut:'https://www.youtube.com/watch?v=' }}" 
            frameborder="0" 
            allowfullscreen>
        </iframe>
      </div>
    </div>

    <!-- Menú Desplegable de Términos Fundamentales -->
    <div class="mb-8">
      <details class="border rounded-xl p-4 bg-gray-50">
        <summary class="cursor-pointer text-xl font-medium text-[#4b7f8c] hover:underline">
          Ver términos fundamentales
        </summary>
        <ul class="mt-4 list-disc pl-6 text-gray-700">
          {% for termino in modulo.terminos.all %}
            <li class="mb-2">
              <span class="font-semibold">{{ termino.termino }}:</span>
              <span>{{ termino.descripcion }}</span>
            </li>
          {% empty %}
            <li>No hay términos disponibles.</li>
          {% endfor %}
        </ul>
      </details>
    </div>

    <!-- Ejercicio Práctico -->
    <div class="mb-8">
      <h3 class="text-2xl font-semibold text-gray-800 mb-2">Ejercicio</h3>
      {% if modulo.ejercicio_instrucciones %}
        <h4 class="text-xl font-semibold text-gray-800 mb-2">Instrucciones:</h4>
        <ul class="list-disc pl-6 text-gray-700 mb-4">
          {% for instruccion in modulo.ejercicio_instrucciones.splitlines %}
            <li class="mb-1">{{ instruccion }}</li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-600 mb-4">No hay instrucciones disponibles para este ejercicio.</p>
      {% endif %}
      <p class="text-lg text-gray-800"><strong>Objetivo:</strong> {{ modulo.ejercicio_objetivo }}</p>
    </div>

    <!-- Botón de Marcar como Completado -->
    <div class="text-center">
      <form method="post" action="{% url 'completar_modulo' modulo.id %}">
        {% csrf_token %}
        <button type="submit" class="bg-[#4b7f8c] hover:bg-[#355f6c] text-white font-bold py-3 px-6 rounded-full transition duration-300 transform hover:scale-105 shadow-lg">
          Marcar como completado
        </button>
        <a href="{% url 'module_list' %}" class="bg-[#abebc6] hover:bg-teal-200 text-gray-800 font-bold py-3 px-6 rounded-full transition duration-300 transform hover:scale-105 shadow-lg">
            Ver todos los modulos Módulos
        </a>
      </form>
    </div>
  </div>
</div>
{% endblock %}
